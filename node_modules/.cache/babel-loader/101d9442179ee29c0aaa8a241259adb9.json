{"ast":null,"code":"module.exports = function (Chart) {\n  var chartHelpers = Chart.helpers;\n\n  var helpers = require('./helpers.js')(Chart);\n\n  function collapseHoverEvents(events) {\n    var hover = false;\n    var filteredEvents = events.filter(function (eventName) {\n      switch (eventName) {\n        case 'mouseenter':\n        case 'mouseover':\n        case 'mouseout':\n        case 'mouseleave':\n          hover = true;\n          return false;\n\n        default:\n          return true;\n      }\n    });\n\n    if (hover && filteredEvents.indexOf('mousemove') === -1) {\n      filteredEvents.push('mousemove');\n    }\n\n    return filteredEvents;\n  }\n\n  function dispatcher(e) {\n    var ns = this.annotation;\n    var elements = helpers.elements(this);\n    var position = chartHelpers.getRelativePosition(e, this.chart);\n    var element = helpers.getNearestItems(elements, position);\n    var events = collapseHoverEvents(ns.options.events);\n    var dblClickSpeed = ns.options.dblClickSpeed;\n    var eventHandlers = [];\n    var eventHandlerName = helpers.getEventHandlerName(e.type);\n    var options = (element || {}).options; // Detect hover events\n\n    if (e.type === 'mousemove') {\n      if (element && !element.hovering) {\n        // hover started\n        ['mouseenter', 'mouseover'].forEach(function (eventName) {\n          var eventHandlerName = helpers.getEventHandlerName(eventName);\n          var hoverEvent = helpers.createMouseEvent(eventName, e); // recreate the event to match the handler\n\n          element.hovering = true;\n\n          if (typeof options[eventHandlerName] === 'function') {\n            eventHandlers.push([options[eventHandlerName], hoverEvent, element]);\n          }\n        });\n      } else if (!element) {\n        // hover ended\n        elements.forEach(function (element) {\n          if (element.hovering) {\n            element.hovering = false;\n            var options = element.options;\n            ['mouseout', 'mouseleave'].forEach(function (eventName) {\n              var eventHandlerName = helpers.getEventHandlerName(eventName);\n              var hoverEvent = helpers.createMouseEvent(eventName, e); // recreate the event to match the handler\n\n              if (typeof options[eventHandlerName] === 'function') {\n                eventHandlers.push([options[eventHandlerName], hoverEvent, element]);\n              }\n            });\n          }\n        });\n      }\n    } // Suppress duplicate click events during a double click\n    // 1. click -> 2. click -> 3. dblclick\n    //\n    // 1: wait dblClickSpeed ms, then fire click\n    // 2: cancel (1) if it is waiting then wait dblClickSpeed ms then fire click, else fire click immediately\n    // 3: cancel (1) or (2) if waiting, then fire dblclick \n\n\n    if (element && events.indexOf('dblclick') > -1 && typeof options.onDblclick === 'function') {\n      if (e.type === 'click' && typeof options.onClick === 'function') {\n        clearTimeout(element.clickTimeout);\n        element.clickTimeout = setTimeout(function () {\n          delete element.clickTimeout;\n          options.onClick.call(element, e);\n        }, dblClickSpeed);\n        e.stopImmediatePropagation();\n        e.preventDefault();\n        return;\n      } else if (e.type === 'dblclick' && element.clickTimeout) {\n        clearTimeout(element.clickTimeout);\n        delete element.clickTimeout;\n      }\n    } // Dispatch the event to the usual handler, but only if we haven't substituted it\n\n\n    if (element && typeof options[eventHandlerName] === 'function' && eventHandlers.length === 0) {\n      eventHandlers.push([options[eventHandlerName], e, element]);\n    }\n\n    if (eventHandlers.length > 0) {\n      e.stopImmediatePropagation();\n      e.preventDefault();\n      eventHandlers.forEach(function (eventHandler) {\n        // [handler, event, element]\n        eventHandler[0].call(eventHandler[2], eventHandler[1]);\n      });\n    }\n  }\n\n  return {\n    dispatcher: dispatcher,\n    collapseHoverEvents: collapseHoverEvents\n  };\n};","map":{"version":3,"names":["module","exports","Chart","chartHelpers","helpers","require","collapseHoverEvents","events","hover","filteredEvents","filter","eventName","indexOf","push","dispatcher","e","ns","annotation","elements","position","getRelativePosition","chart","element","getNearestItems","options","dblClickSpeed","eventHandlers","eventHandlerName","getEventHandlerName","type","hovering","forEach","hoverEvent","createMouseEvent","onDblclick","onClick","clearTimeout","clickTimeout","setTimeout","call","stopImmediatePropagation","preventDefault","length","eventHandler"],"sources":["D:/Soft/Desk 12.10/TestTS/node_modules/chartjs-plugin-annotation/src/events.js"],"sourcesContent":["module.exports = function(Chart) {\n\tvar chartHelpers = Chart.helpers;\n\tvar helpers = require('./helpers.js')(Chart);\n\n\tfunction collapseHoverEvents(events) {\n\t\tvar hover = false;\n\t\tvar filteredEvents = events.filter(function(eventName) {\n\t\t\tswitch (eventName) {\n\t\t\t\tcase 'mouseenter':\n\t\t\t\tcase 'mouseover':\n\t\t\t\tcase 'mouseout':\n\t\t\t\tcase 'mouseleave':\n\t\t\t\t\thover = true;\n\t\t\t\t\treturn false;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\tif (hover && filteredEvents.indexOf('mousemove') === -1) {\n\t\t\tfilteredEvents.push('mousemove');\n\t\t}\n\t\treturn filteredEvents;\n\t}\n\n\tfunction dispatcher(e) {\n\t\tvar ns = this.annotation;\n\t\tvar elements = helpers.elements(this);\n\t\tvar position = chartHelpers.getRelativePosition(e, this.chart);\n\t\tvar element = helpers.getNearestItems(elements, position);\n\t\tvar events = collapseHoverEvents(ns.options.events);\n\t\tvar dblClickSpeed = ns.options.dblClickSpeed;\n\t\tvar eventHandlers = [];\n\t\tvar eventHandlerName = helpers.getEventHandlerName(e.type);\n\t\tvar options = (element || {}).options;\n\n\t\t// Detect hover events\n\t\tif (e.type === 'mousemove') {\n\t\t\tif (element && !element.hovering) {\n\t\t\t\t// hover started\n\t\t\t\t['mouseenter', 'mouseover'].forEach(function(eventName) {\n\t\t\t\t\tvar eventHandlerName = helpers.getEventHandlerName(eventName);\n\t\t\t\t\tvar hoverEvent = helpers.createMouseEvent(eventName, e); // recreate the event to match the handler\n\t\t\t\t\telement.hovering = true;\n\t\t\t\t\tif (typeof options[eventHandlerName] === 'function') {\n\t\t\t\t\t\teventHandlers.push([ options[eventHandlerName], hoverEvent, element ]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (!element) {\n\t\t\t\t// hover ended\n\t\t\t\telements.forEach(function(element) {\n\t\t\t\t\tif (element.hovering) {\n\t\t\t\t\t\telement.hovering = false;\n\t\t\t\t\t\tvar options = element.options;\n\t\t\t\t\t\t['mouseout', 'mouseleave'].forEach(function(eventName) {\n\t\t\t\t\t\t\tvar eventHandlerName = helpers.getEventHandlerName(eventName);\n\t\t\t\t\t\t\tvar hoverEvent = helpers.createMouseEvent(eventName, e); // recreate the event to match the handler\n\t\t\t\t\t\t\tif (typeof options[eventHandlerName] === 'function') {\n\t\t\t\t\t\t\t\teventHandlers.push([ options[eventHandlerName], hoverEvent, element ]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Suppress duplicate click events during a double click\n\t\t// 1. click -> 2. click -> 3. dblclick\n\t\t//\n\t\t// 1: wait dblClickSpeed ms, then fire click\n\t\t// 2: cancel (1) if it is waiting then wait dblClickSpeed ms then fire click, else fire click immediately\n\t\t// 3: cancel (1) or (2) if waiting, then fire dblclick \n\t\tif (element && events.indexOf('dblclick') > -1 && typeof options.onDblclick === 'function') {\n\t\t\tif (e.type === 'click' && typeof options.onClick === 'function') {\n\t\t\t\tclearTimeout(element.clickTimeout);\n\t\t\t\telement.clickTimeout = setTimeout(function() {\n\t\t\t\t\tdelete element.clickTimeout;\n\t\t\t\t\toptions.onClick.call(element, e);\n\t\t\t\t}, dblClickSpeed);\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t} else if (e.type === 'dblclick' && element.clickTimeout) {\n\t\t\t\tclearTimeout(element.clickTimeout);\n\t\t\t\tdelete element.clickTimeout;\n\t\t\t}\n\t\t}\n\n\t\t// Dispatch the event to the usual handler, but only if we haven't substituted it\n\t\tif (element && typeof options[eventHandlerName] === 'function' && eventHandlers.length === 0) {\n\t\t\teventHandlers.push([ options[eventHandlerName], e, element ]);\n\t\t}\n\n\t\tif (eventHandlers.length > 0) {\n\t\t\te.stopImmediatePropagation();\n\t\t\te.preventDefault();\n\t\t\teventHandlers.forEach(function(eventHandler) {\n\t\t\t\t// [handler, event, element]\n\t\t\t\teventHandler[0].call(eventHandler[2], eventHandler[1]);\n\t\t\t});\n\t\t}\n\t}\n\n\treturn {\n\t\tdispatcher: dispatcher,\n\t\tcollapseHoverEvents: collapseHoverEvents\n\t};\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}